{"version":3,"file":"hyperGard.es.js","sources":["lib/extend.js","lib/urltemplate.js","lib/urlparse.js","src/hyperGard.js"],"sourcesContent":["/**\n * Copyright 2018 Comcast Cable Communications Management, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or   implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nvar typeObj = {};\nvar slice = [].slice;\nvar toString = typeObj.toString;\n\nvar getType = function(mixed) {\n  if (mixed == null) {\n    return mixed + '';\n  }\n\n  return typeof mixed === 'object' || typeof mixed === 'function' ?\n            typeObj[toString.call(mixed)] || 'object' : typeof mixed;\n};\n\nvar isSpecificValue = function(val) {\n  return getType(val) === 'buffer' || getType(val) === 'date' || getType(val) === 'regexp';\n};\n\nvar cloneSpecificValue = function(val) {\n  var valType = getType(val);\n  var x;\n\n  if (valType === 'buffer') {\n    x = new Buffer(val.length);\n    val.copy(x);\n    return x;\n  }\n\n  if (valType === 'date') {\n    return new Date(val.getTime());\n  }\n\n  if (valType === 'regexp') {\n    return new RegExp(val);\n  }\n\n  throw new Error('Unexpected situation');\n};\n\n/**\n * Recursive cloning array.\n */\nvar deepCloneArray = function(arr) {\n  var clone = [];\n\n  arr.forEach(function(item, index) {\n    if (getType(item) === 'object') {\n      if (Array.isArray(item)) {\n        clone[index] = deepCloneArray(item);\n      } else if (isSpecificValue(item)) {\n        clone[index] = cloneSpecificValue(item);\n      } else {\n        clone[index] = deepExtend({}, item);\n      }\n    } else {\n      clone[index] = item;\n    }\n  });\n\n  return clone;\n};\n\n/**\n * Extening object that entered in first argument.\n *\n * Returns extended object or false if have no target object or incorrect type.\n *\n * If you wish to clone source object (without modify it), just use empty new\n * object as first argument, like this:\n *   deepExtend({}, yourObj_1, [yourObj_N]);\n */\nvar deepExtend = function(/*obj_1, [obj_2], [obj_N]*/) {\n  if (arguments.length < 1 || getType(arguments[0]) !== 'object') {\n    return false;\n  }\n\n  if (arguments.length < 2) {\n    return arguments[0];\n  }\n\n  var target = arguments[0];\n  var args = slice.call(arguments, 1);\n  var val, src;\n\n  args.forEach(function(obj) {\n    // skip argument if it is array or isn't object\n    if (getType(obj) !== 'object' || Array.isArray(obj)) {\n      return;\n    }\n\n    Object.keys(obj).forEach(function(key) {\n      src = target[key]; // source value\n      val = obj[key]; // new value\n\n      // recursion prevention\n      if (val !== target) {\n        if (getType(val) !== 'object' || val === null) {\n          target[key] = val;\n        } else if (Array.isArray(val)) {\n          // just clone arrays (and recursive clone objects inside)\n          target[key] = deepCloneArray(val);\n        } else if (isSpecificValue(val)) {\n          // custom cloning and overwrite for specific objects\n          target[key] = cloneSpecificValue(val);\n        } else if (getType(src) !== 'object' || src === null || Array.isArray(src)) {\n          // overwrite by new value if source isn't object or array\n          target[key] = deepExtend({}, val);\n        } else {\n          // source value and new value is objects both, extending...\n          target[key] = deepExtend(src, val);\n        }\n      }\n    });\n  });\n\n  return target;\n};\n\n['Boolean', 'Number', 'String', 'Function', 'Array', 'Date', 'RegExp', 'Object', 'Error'].forEach(function(name) {\n  typeObj[\"[object \" + name + \"]\"] = name.toLowerCase();\n});\n\nexport default deepExtend;\n\n","/**\n * Copyright 2018 Comcast Cable Communications Management, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or   implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @constructor\n */\nfunction UrlTemplate() {\n  var\n    /**\n     * Operators\n     * @type {String[]}\n     */\n    operators = ['+', '#', '.', '/', ';', '?', '&'],\n\n    parseTemplate = /\\{([^\\{\\}]+)\\}|([^\\{\\}]+)/g,\n    parseVariable = /([^:\\*]*)(?::(\\d+)|(\\*))?/,\n\n    /**\n     * @private\n     * @param {string} str\n     * @return {string}\n     */\n    encodeReserved = function(str) {\n      return str.split(/(%[0-9A-Fa-f]{2})/g).map(function(part) {\n        if (!/%[0-9A-Fa-f]/.test(part)) {\n          part = encodeURI(part);\n        }\n        return part;\n      }).join('');\n    },\n\n    /**\n     * @private\n     * @param {string} operator\n     * @param {string} value\n     * @param {string} key\n     * @return {string}\n     */\n    encodeValue = function(operator, value, key) {\n      value = (operator === '+' || operator === '#') ? encodeReserved(value) : encodeURIComponent(value);\n      return key ? encodeURIComponent(key) + '=' + value : value;\n    },\n\n    /**\n     * @private\n     * @param {*} value\n     * @return {boolean}\n     */\n    isDefined = function(value) {\n      return value !== undefined && value !== null;\n    },\n\n    /**\n     * @private\n     * @param {string} operator\n     * @return {boolean}\n     */\n    isKeyOperator = function(operator) {\n      return operator === ';' || operator === '&' || operator === '?';\n    },\n\n    /**\n     * @private\n     * @param {Object} context\n     * @param {string} operator\n     * @param {string} key\n     * @param {string} modifier\n     */\n    getValues = function(context, operator, key, modifier) {\n      var\n        value = context[key],\n        result = [];\n\n      if (typeof value !== 'undefined' && value !== null) {\n        if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n          value = value.toString();\n\n          if (modifier && modifier !== '*') {\n            value = value.substring(0, parseInt(modifier, 10));\n          }\n\n          result.push(encodeValue(operator, value, isKeyOperator(operator) ? key : null));\n        } else {\n          if (modifier === '*') {\n            if (Array.isArray(value)) {\n              value.filter(isDefined).forEach(function(value) {\n                result.push(encodeValue(operator, value, isKeyOperator(operator) ? key : null));\n              });\n            } else {\n              Object.keys(value).forEach(function(k) {\n                if (isDefined(value[k])) {\n                  result.push(encodeValue(operator, value[k], k));\n                }\n              });\n            }\n          } else {\n            var tmp = [];\n\n            if (Array.isArray(value)) {\n              value.filter(isDefined).forEach(function(value) {\n                tmp.push(encodeValue(operator, value, ''));\n              });\n            } else {\n              Object.keys(value).forEach(function(k) {\n                if (isDefined(value[k])) {\n                  tmp.push(encodeURIComponent(k));\n                  tmp.push(encodeValue(operator, value[k].toString(), ''));\n                }\n              });\n            }\n\n            if (isKeyOperator(operator)) {\n              result.push(encodeURIComponent(key) + '=' + tmp.join(','));\n            } else if (tmp.length !== 0) {\n              result.push(tmp.join(','));\n            }\n          }\n        }\n      } else {\n        if (operator === ';') {\n          result.push(encodeURIComponent(key));\n        } else if (value === '' && (operator === '&' || operator === '?')) {\n          result.push(encodeURIComponent(key) + '=');\n        } else if (value === '') {\n          result.push('');\n        }\n      }\n\n      return result;\n    };\n\n  /**\n   * @param {String} url\n   * @param {Object} params to be applied\n   * @return {string}\n   */\n  this.expand = function(url, params) {\n    return url.replace(parseTemplate, function(_, expression, literal) {\n      var\n        result;\n\n      if (expression) {\n        var\n          operator,\n          values = [];\n\n        if (operators.indexOf(expression.charAt(0)) !== -1) {\n          operator = expression.charAt(0);\n          expression = expression.substr(1);\n\n          if ((url.match(/\\?/g) || []).length > 1) {\n            operator = '&';\n          }\n        }\n\n        expression.split(/,/g).forEach(function(variable) {\n          var tmp = parseVariable.exec(variable);\n          values.push.apply(values, getValues(params, operator, tmp[1], tmp[2] || tmp[3]));\n        });\n\n        if (operator && operator !== '+') {\n          var separator = ',';\n\n          if (operator === '?') {\n            separator = '&';\n          } else if (operator !== '#') {\n            separator = operator;\n          }\n\n          result = (values.length ? operator : '') + values.join(separator);\n        } else {\n          result = values.join(',');\n        }\n      } else {\n        result = encodeReserved(literal);\n      }\n\n      return result;\n    });\n  };\n\n  this.extractParams = function(url) {\n    var\n      result = [];\n\n    url.replace(parseTemplate, function(_, expression) {\n      if (expression) {\n        if (operators.indexOf(expression.charAt(0)) !== -1) {\n          expression = expression.substr(1);\n        }\n        result = result.concat(expression.split(/,/g));\n      }\n    });\n\n    return result;\n  };\n}\n\nexport default new UrlTemplate();\n","/**\n * Copyright 2018 Comcast Cable Communications Management, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or   implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n /**\n * @constructor\n */\nfunction UrlParse() {\n  var\n  // scheme (optional), host, port\n    fullurl = /^([A-Za-z]+)?(:?\\/\\/)([0-9.\\-A-Za-z]*)(?::(\\d+))?(.*)$/,\n  // path, query, fragment\n    parse_leftovers = /([^?#]*)?(?:\\?([^#]*))?(?:#(.*))?$/;\n\n  // Unlike to be useful standalone\n  //\n  // NORMALIZE PATH with \"../\" and \"./\"\n  //   http://en.wikipedia.org/wiki/URL_normalization\n  //   http://tools.ietf.org/html/rfc3986#section-5.2.3\n  //\n  this.normalizepath = function(path) {\n    if (!path || path === '/') {\n      return '/';\n    }\n\n    var\n      parts = path.split('/'),\n      newparts = [];\n\n    // make sure path always starts with '/'\n    if (parts[0]) {\n      newparts.push('');\n    }\n\n    parts.forEach(function(part) {\n      if (part === '..') {\n        if (newparts.length > 1) {\n          newparts.pop();\n        } else {\n          newparts.push(part);\n        }\n      } else if (part !== '.') {\n        newparts.push(part);\n      }\n    });\n\n    return newparts.join('/') || '/';\n  };\n\n  //\n  // Does many of the normalizations that the stock\n  //  python urlsplit/urlunsplit/urljoin neglects\n  //\n  // Doesn't do hex-escape normalization on path or query\n  //   %7e -> %7E\n  // Nor, '+' <--> %20 translation\n  //\n  this.urlnormalize = function(url) {\n    var parts = this.urlsplit(url);\n\n    switch (parts.scheme) {\n      case 'file':\n        // files can't have query strings\n        //  and we don't bother with fragments\n        parts.query = '';\n        parts.fragment = '';\n        break;\n      case 'http':\n      case 'https':\n        // remove default port\n        if ((parts.scheme === 'http' && parts.port == 80) ||\n          (parts.scheme === 'https' && parts.port == 443)) {\n          delete parts.port;\n          // hostname is already lower case\n          parts.netloc = parts.hostname;\n        }\n        break;\n      default:\n        // if we don't have specific normalizations for this\n        // scheme, return the original url unmolested\n        return url;\n    }\n\n    // for [file|http|https].  Not sure about other schemes\n    parts.path = this.normalizepath(parts.path);\n\n    return this.urlunsplit(parts);\n  };\n\n  this.urldefrag = function(url) {\n    var idx = url.indexOf('#');\n    return (idx === -1) ? [url, ''] : [url.substr(0, idx), url.substr(idx + 1)];\n  };\n\n  this.urlsplit = function(url, default_scheme, allow_fragments) {\n    allow_fragments = allow_fragments !== false;\n\n    var\n      leftover,\n      o = {},\n      parts = (url || '').match(fullurl);\n\n    if (parts) {\n      o.scheme = parts[1] || default_scheme || '';\n      o.hostname = parts[3].toLowerCase() || '';\n      o.port = parseInt(parts[4], 10) || '';\n      // Probably should grab the netloc from regexp\n      //  and then parse again for hostname/port\n\n      o.netloc = parts[3];\n\n      if (parts[4]) {\n        o.netloc += ':' + parts[4];\n      }\n\n      leftover = parts[5];\n    } else {\n      o.scheme = default_scheme || '';\n      o.netloc = '';\n      o.hostname = '';\n      leftover = url;\n    }\n    o.scheme = o.scheme.toLowerCase();\n\n    parts = leftover.match(parse_leftovers);\n\n    o.path = parts[1] || '';\n    o.query = parts[2] || '';\n\n    o.fragment = allow_fragments ? (parts[3] || '') : '';\n\n    return o;\n  };\n\n  this.urlunsplit = function(o) {\n    var s = '';\n\n    if (o.scheme) {\n      s += o.scheme + '://';\n    }\n\n    if (o.netloc) {\n      if (s === '') {\n        s += '//';\n      }\n\n      s += o.netloc;\n    } else if (o.hostname) {\n      // extension.  Python only uses netloc\n      if (s === '') {\n        s += '//';\n      }\n\n      s += o.hostname;\n\n      if (o.port) {\n        s += ':' + o.port;\n      }\n    }\n\n    if (o.path) {\n      s += o.path;\n    }\n\n    if (o.query) {\n      s += '?' + o.query;\n    }\n\n    if (o.fragment) {\n      s += '#' + o.fragment;\n    }\n\n    return s;\n  };\n\n  this.urljoin = function(base, url, allow_fragments) {\n    if (typeof allow_fragments === 'undefined') {\n      allow_fragments = true;\n    }\n\n    var url_parts = this.urlsplit(url);\n\n    // if url parts has a scheme (i.e. absolute)\n    // then nothing to do\n    if (url_parts.scheme) {\n      return !allow_fragments ? url : this.urldefrag(url)[0];\n    }\n\n    var base_parts = this.urlsplit(base);\n\n    // copy base, only if not present\n    if (!base_parts.scheme) {\n      base_parts.scheme = url_parts.scheme;\n    }\n\n    // copy netloc, only if not present\n    if (!base_parts.netloc || !base_parts.hostname) {\n      base_parts.netloc = url_parts.netloc;\n      base_parts.hostname = url_parts.hostname;\n      base_parts.port = url_parts.port;\n    }\n\n    // paths\n    if (url_parts.path.length > 0) {\n      if (url_parts.path.charAt(0) === '/') {\n        base_parts.path = url_parts.path;\n      } else {\n        // relative path.. get rid of \"current filename\" and\n        //   replace.  Same as var parts =\n        //   base_parts.path.split('/'); parts[parts.length-1] =\n        //   url_parts.path; base_parts.path = parts.join('/');\n        var idx = base_parts.path.lastIndexOf('/');\n        if (idx === -1) {\n          base_parts.path = url_parts.path;\n        } else {\n          base_parts.path = base_parts.path.substr(0, idx) + '/' +\n            url_parts.path;\n        }\n      }\n    }\n\n    // clean up path\n    base_parts.path = this.normalizepath(base_parts.path);\n\n    // copy query string\n    base_parts.query = url_parts.query;\n\n    // copy fragments\n    base_parts.fragment = allow_fragments ? url_parts.fragment : '';\n\n    return this.urlunsplit(base_parts);\n  };\n}\n\nexport default new UrlParse();\n","/**\n * Copyright 2018 Comcast Cable Communications Management, LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or   implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nimport deepExtend from '../lib/extend.js';\nimport urltemplate from '../lib/urltemplate.js';\nimport urlparse from '../lib/urlparse.js';\n\nvar\n  version = '5.3.0',\n\n  defaultOptions = {\n    preloadHomepage: true,\n    cacheHomepage: false,\n    debug: false,\n\n    xhr: {\n      headers: {\n        Accept: 'application/hal+json, application/json, */*; q=0.01',\n        'X-HyperGard': version\n      }\n    }\n  },\n\n  excludedProps = /^(_embedded|_links|_forms)$/,\n  excludeBody = /^(head|get)$/i,\n  concat = [].concat,\n  keys = Object.keys,\n\n  isObject = function(value) {\n    return !!value && {}.toString.call(value) === '[object Object]';\n  },\n\n  xhrStatus = function(response) {\n    return (response.status >= 200 && response.status < 300) ? response :\n      Promise.reject(response instanceof Response ? response : new Response('', {\n        status: 503,\n        statusText: 'Possible CORS error'\n      }));\n  },\n\n  xhrTimeout = function(timeout) {\n    return new Promise(function(res, rej) {\n      setTimeout(function() {\n        rej({\n          error: {\n            code: '0011',\n            msg: 'Fetch timeout',\n            timeout: timeout\n          }\n        });\n      }, timeout);\n    });\n  },\n\n  load = function(url, fetchOptions) {\n    var o = deepExtend({}, defaultOptions.xhr, fetchOptions);\n\n    return Promise.race([\n        xhrTimeout(fetchOptions.timeout || 60000),\n        fetch(url, o)\n      ]).then(xhrStatus);\n  },\n\n  urlSerialize = function(obj) {\n    return Object.keys(obj).map(function(key) {\n      return encodeURIComponent(key) + '=' + encodeURIComponent(obj[key]);\n    }).join('&');\n  },\n\n  HyperGard = function(endpoint, initOptions) {\n    var\n      homepage,\n      homepageLoaded = false,\n      options = deepExtend({}, defaultOptions, initOptions || {}),\n      linkRefs = {},\n\n      parseCuries = function(curies) {\n        var result = {};\n\n        (curies || []).forEach(function(curie) {\n          if (curie.name) {\n            result[curie.name] = curie;\n          }\n        });\n\n        return result;\n      },\n\n      parseEmbedded = function(res, parent) {\n        var\n          result = {};\n\n        keys(res).forEach(function(key) {\n          result[key] = Array.isArray(res[key]) ? res[key].map(function(item) {\n            return new EmbeddedResource(item, parent);\n          }) : new EmbeddedResource(res[key], parent);\n        });\n\n        return result;\n      },\n\n      sharedResourceAPI = function(obj, res, parent, base) {\n        var\n          props = {},\n          link = ((res._links || {}).self || {}).href || '',\n          actions = [],\n          embedded = parseEmbedded(res._embedded || {}, obj);\n\n        keys(res).forEach(function(key) {\n          if (!excludedProps.test(key)) {\n            this[key] = res[key];\n          }\n        }, props);\n\n        /**\n         * Get Action\n         * @description Allow to follow actions (links, forms) on HAL resources and embedded resources\n         * @param {String} name The name of the action to be taken\n         * @param {Object} params Parameters to populate the action\n         * @returns {Array} List of available actions\n         */\n        obj.getAction = function(name, params) {\n          if (!actions[name]) {\n            actions[name] = [];\n\n            var\n              linkCuries = parseCuries((res._links || {}).curies),\n              formCuries = parseCuries((res._forms || {}).curies),\n              curieName = String(name).split(':')[0] || '';\n\n            concat.call([], (res._links || {})[name]).forEach(function(lnk) {\n              if (lnk) {\n                lnk.curie = linkCuries[curieName];\n                actions[name].push(new Action(this, name, lnk, params, 'link'));\n              }\n            }, this);\n\n            concat.call([], (res._forms || {})[name]).forEach(function(frm) {\n              if (frm) {\n                frm.curie = formCuries[curieName];\n                actions[name].push(new Action(this, name, frm, params, 'form'));\n              }\n            }, this);\n          }\n\n          return actions[name].map(function(action) {\n            return action.setParams(params);\n          });\n        };\n\n        /**\n         * Get base api path\n         * @returns {String}\n         */\n        obj.getBase = function() {\n          return base || parent.getBase();\n        };\n\n        /**\n         * Get embedded object\n         * @param {String} name Name of the embedded object\n         * @returns {Object}\n         */\n        obj.getEmbedded = function(name) {\n          return embedded[name];\n        };\n\n        /**\n         * Fetch embedded\n         * @description Get the object from embedded or follow a link with the same name\n         * @param {String} name Name of the embedded object\n         * @param {Object} [options] to provide to fetch for actions\n         * @returns {Promise}\n         */\n        obj.fetchEmbedded = function(name, options) {\n          return this.hasEmbedded(name) ? Promise.resolve({\n            data: this.getEmbedded(name)\n          }) : this.getFirstAction(name).fetch(options);\n        };\n\n        /**\n         * Get first action from getAction list\n         * @description Convenience method to get the first action instead of using getAction()[0]\n         * @param {String} name The name of the action to be taken\n         * @param {Object} params Parameters to populate the action\n         * @returns {Object} Get Action API\n         */\n        obj.getFirstAction = function(name, params) {\n          return this.getAction(name, params)[0] || new Action(this, name, {}, {}, 'none');\n        };\n\n        /**\n         * Get parent resource object\n         * @returns {Object}\n         */\n        obj.getParent = function() {\n          return parent;\n        };\n\n        /**\n         * Get property value\n         * @returns {*}\n         */\n        obj.getProp = function(prop) {\n          return props[prop];\n        };\n\n        /**\n         * Get all properties as an object\n         * @returns {Object}\n         */\n        obj.getProps = function() {\n          return props;\n        };\n\n        /**\n         * Does an object have a given action?\n         * @description Convenience method to find out if an object has a link or form\n         * @param {String} name The name of the action\n         * @returns {Boolean}\n         */\n        obj.hasAction = function(name) {\n          return obj.hasLink(name) || obj.hasForm(name);\n        };\n\n        /**\n         * Does a resource contain a given embedded obj?\n         * @description Convenience method to find out if a resource contains an embedded object\n         * @param {String} name The name of the embedded obj\n         * @returns {Boolean}\n         */\n        obj.hasEmbedded = function(name) {\n          return !!embedded[name];\n        };\n\n        /**\n         * Does an object have a given form?\n         * @description Convenience method to find out if an object has a form\n         * @param {String} name The name of the form\n         * @returns {Boolean}\n         */\n        obj.hasForm = function(name) {\n          return obj.listActions().forms.indexOf(name) >= 0;\n        };\n\n        /**\n         * Does an object have a given link?\n         * @description Convenience method to find out if an object has a link\n         * @param {String} name The name of the link\n         * @returns {Boolean}\n         */\n        obj.hasLink = function(name) {\n          return obj.listActions().links.indexOf(name) >= 0;\n        };\n\n        /**\n         * List of all available actions\n         * @returns {Object}\n         */\n        obj.listActions = function() {\n          var\n            filter = function(item) {\n              return item !== 'curies';\n            };\n\n          return {\n            links: keys(res._links || {}).filter(filter),\n            forms: keys(res._forms || {}).filter(filter)\n          };\n        };\n\n        /**\n         * List of all available embedded objects\n         * @returns {Array}\n         */\n        obj.listEmbedded = function() {\n          return keys(embedded);\n        };\n\n\n        if (options.debug) {\n          /**\n           * original HAL resource\n           */\n          obj.resource = res;\n        }\n\n        if (!base) {\n          /**\n           * Get root level resource\n           */\n          obj.getRoot = function() {\n            var root;\n\n            do {\n              root =  this.getParent();\n            } while (!(root instanceof Resource));\n\n            return root;\n          };\n        }\n\n        if (link) {\n          linkRefs[link] = obj;\n        }\n      },\n\n      /**\n       * Action instance\n       * @param {Object} parent Parent resource\n       * @param {String} name Action name\n       * @param {Object} action Action object\n       * @param {Object} [params] Params to be used for templated action\n       * @param {String} type Internal identification of action type\n       * @constructor\n       */\n      Action = function(parent, name, action, params, type) {\n        var\n          api = this,\n          rawUrl = (action.href || action.action || '').replace(/^#/, ''),\n          method = action.method || (type === 'form' ? 'POST' : 'GET'),\n          actionUrl = '',\n          payLoad = '';\n\n        /**\n         * Get action name\n         * @returns {String}\n         */\n        api.getActionName = function() {\n          return name;\n        };\n\n        /**\n         * Get action type\n         * @returns {String}\n         */\n        api.getActionType = function() {\n          return type;\n        };\n\n        /**\n         * Get formatted url for the action\n         * @returns {String}\n         */\n        api.getActionUrl = function() {\n          return actionUrl;\n        };\n\n        /**\n         * Get action method\n         * @returns {String}\n         */\n        api.getMethod = function() {\n          return method;\n        };\n\n        /**\n         * Get params that need are required for the action\n         * @returns {Array}\n         */\n        api.getParams = function() {\n          return urltemplate.extractParams(rawUrl);\n        };\n\n        /**\n         * Get un-formatted url for the action\n         * @returns {String}\n         */\n        api.getRawActionUrl = function() {\n          return rawUrl;\n        };\n\n        /**\n         * Get action title\n         * @returns {String}\n         */\n        api.getTitle = function() {\n          return action.title || '';\n        };\n\n        /**\n         * Get action template flag\n         * @returns {Boolean}\n         */\n        api.isTemplated = function() {\n          return action.templated || false;\n        };\n\n        api.setParams = function(params) {\n          actionUrl = action.templated ? urltemplate.expand(rawUrl, params || {}) : rawUrl;\n\n          if (actionUrl) {\n            actionUrl = urlparse.urljoin(action.curie ? action.curie.href : parent.getBase(), actionUrl);\n          }\n\n          if (type === 'form') {\n            if (action.fields && isObject(params)) {\n              payLoad = {};\n              keys(action.fields).forEach(function(field) {\n                if (params.hasOwnProperty(field)) {\n                  payLoad[field] = params[field];\n                } else if (action.fields[field].hasOwnProperty('default')) {\n                  payLoad[field] = action.fields[field]['default'];\n                }\n              });\n            } else if (params) {\n              payLoad = JSON.stringify(params);\n            }\n\n            if (excludeBody.test(method) && payLoad) {\n              actionUrl = urlparse.urljoin(actionUrl, '?' + urlSerialize(payLoad));\n              payLoad = '';\n            }\n          }\n\n          return api;\n        };\n\n        if (type === 'form') {\n          /**\n           * Get form fields for the form action\n           * @returns {Object}\n           */\n          api.getFields = function() {\n            return action.fields || {};\n          };\n\n          /**\n           * Get payload to be submitted for the form action\n           * @returns {Object}\n           */\n          api.getPayload = function() {\n            return payLoad;\n          };\n        }\n\n        if (action.curie) {\n          /**\n           * Get curie documentation url\n           * @returns {String}\n           */\n          api.getDocUrl = function() {\n            return urltemplate.expand(action.curie.href, {\n              rel: name.split(':')[1]\n            });\n          };\n        }\n\n        api.setParams(params);\n      },\n\n      /**\n       * HAL Embedded resource\n       * @param {Resource} res HAL resource\n       * @param {Resource} parent Parent HAL resource\n       * @constructor\n       */\n      EmbeddedResource = function(res, parent) {\n        return sharedResourceAPI(this, res || {}, parent);\n      },\n\n      /**\n       * HAL Resource\n       * @param {String} base Base url for the resource\n       * @param {Object} res Resource data\n       * @constructor\n       */\n      Resource = function(base, res) {\n        return sharedResourceAPI(this, res, this, base);\n      };\n\n    Action.prototype.fetch = function(fetchOptions) {\n      fetchOptions || (fetchOptions = {});\n\n      var\n        url = fetchOptions.url || this.getActionUrl(),\n        rawUrl = this.getRawActionUrl(),\n        name = this.getActionName(),\n        payLoad = this.getPayload ? this.getPayload() : '',\n        o = deepExtend({\n          method: this.getMethod(),\n          action: name,\n        }, options.xhr, fetchOptions),\n\n        onSuccess = function(response) {\n          if (response.status === 204) {\n            return Promise.resolve({\n              action: name,\n              data: '',\n              xhr: response\n            });\n          }\n\n          /**\n           * If flag to returnRawData is false & the object is a valid\n           * use Resource constructor\n           * @param {} data\n           */\n          function formatData(data) {\n            if (!o.returnRawData && isObject(data)) {\n              return new Resource(url, data);\n            }\n\n            return data;\n          }\n\n          return response.json().then(function(data) {\n            return {\n              action: name,\n              data: formatData(data),\n              xhr: response\n            };\n          }, function() {\n            return {\n              action: name,\n              data: response.text(),\n              xhr: response\n            };\n          });\n        },\n\n        onError = function(response) {\n          return Promise.reject(response instanceof Response ? {\n            error: {\n              action: name,\n              code: '0021',\n              msg: 'Failed to retrieve action'\n            },\n            xhr: response\n          } : response);\n        };\n\n      if (!excludeBody.test(o.method) && isObject(payLoad)) {\n        o.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n        o.body = urlSerialize(payLoad);\n      }\n\n      if (!url) {\n        return Promise.reject({\n          error: {\n            action: name,\n            code: '0020',\n            msg: 'Url is not provided for this action'\n          }\n        });\n      } else if (o.method === 'GET' && !fetchOptions.force && linkRefs.hasOwnProperty(rawUrl)) {\n        return Promise.resolve({\n          action: name,\n          data: linkRefs[rawUrl]\n        });\n      }\n\n      return load(url, o).then(onSuccess, onError);\n    };\n\n    /**\n     * Fetch\n     * @returns {Promise}\n     */\n    this.fetch = function() {\n      var o = deepExtend({\n        method: 'GET',\n        action: 'homepage',\n      }, options.xhr);\n      var\n        onSuccess = function(response) {\n          if (!options.cacheHomepage) {\n            homepageLoaded = false;\n          }\n\n          return response.json().then(function(data) {\n            return isObject(data) ? {\n              data: new Resource(endpoint, data),\n              xhr: response\n            } : Promise.reject();\n          })['catch'](function() {\n            return Promise.reject({\n              error: {\n                code: '0002',\n                msg: 'Could not parse homepage'\n              },\n              xhr: response\n            });\n          });\n        },\n\n        onError = function(response) {\n          homepageLoaded = false;\n\n          return Promise.reject(response instanceof Response ? {\n            error: {\n              code: '0001',\n              msg: 'Failed to retrieve homepage'\n            },\n            xhr: response\n          } : response);\n        };\n\n      if (!endpoint) {\n        return Promise.reject({\n          error: {\n            code: '0000',\n            msg: 'API endpoint was not provided'\n          }\n        });\n      }\n\n      if (!homepageLoaded) {\n        homepageLoaded = true;\n        homepage = load(endpoint, o).then(onSuccess, onError);\n      }\n\n      return homepage;\n    };\n\n    /**\n     * Set global options\n     * @param {Object} o Options object\n     * @return {Object} HyperGard\n     */\n    this.setOptions = function(o) {\n      deepExtend(options, o || {});\n      return this;\n    };\n\n    /**\n     * Get global options\n     * @returns {Object}\n     */\n    this.getOptions = function() {\n      return options;\n    };\n\n    /**\n     * Parse json into resource\n     * @param {Object} json Data in json format to be parsed as resource\n     * @returns {Resource}\n     */\n    this.parse = function(json) {\n      return new Resource(endpoint, json || {});\n    };\n\n    /**\n     * Fetch homepage on initialization\n     */\n    if (options.preloadHomepage) {\n      this.fetch();\n    }\n\n    /**\n     * Turns a raw response into a HyperGard resource object\n     * This needs closure over a specific instance of a `Hypergard` object\n     **/\n    this.generateResource = function(response) {\n      var path = response && response._links && response._links.self && response._links.self.href;\n      var resourceUrl = urlparse.urljoin(endpoint, path);\n\n      return new Resource(resourceUrl, response);\n    };\n  };\n\nHyperGard.prototype.version = version;\n\n/**\n * Will wrap any fetch performed in supplied middleware\n * This will allow custom logging headers to be set without\n * using before/after fetch events\n * @param {Function} middleware Function to wrap fetches in\n */\nfunction applyMiddleware(middleware) {\n  load = (function(stack) {\n    return function(url, fetchOptions) {\n      return middleware(url, fetchOptions, stack);\n    };\n  })(load);\n}\n\n/**\n * Will apply an array of middleware functions around the load method\n * @param {Array} middlewareStack Array of functions to be wrapped around every load\n */\nHyperGard.prototype.applyMiddlewareStack = function(middlewareStack) {\n  var applicationOrder;\n  if (middlewareStack && Array.isArray(middlewareStack) && middlewareStack.length) {\n    // Apply in reverse order, for first entry is applied as inner most wrapper\n    applicationOrder = middlewareStack.reverse();\n    applicationOrder.forEach(applyMiddleware);\n  }\n};\n\nexport default HyperGard;\n\n"],"names":[],"mappings":"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"}